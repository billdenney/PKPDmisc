<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multiplots • PKPDmisc</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">PKPDmisc</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Multiplots</h1>
                        <h4 class="author">Devin Pastoor</h4>
            
            <h4 class="date">2017-02-13</h4>
          </div>

    
    
<div class="contents">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(PKPDmisc) <span class="co"># for binning and other functions</span>
<span class="kw">library</span>(PKPDdatasets) <span class="co"># example dataset</span>
<span class="kw">library</span>(ggplot2) <span class="co">#plotting</span>
<span class="kw">library</span>(purrr) <span class="co"># dataset to handle lists</span></code></pre></div>
<pre><code>## 
## Attaching package: 'purrr'</code></pre>
<pre><code>## The following objects are masked from 'package:dplyr':
## 
##     contains, order_by</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressMessages</span>(<span class="kw">suppressWarnings</span>(<span class="kw">library</span>(dplyr)))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span>sd_oral_richpk %&gt;%<span class="st"> </span><span class="kw">filter</span>(ID &lt;=<span class="st"> </span><span class="dv">20</span>)</code></pre></div>
<p>Messy plot can’t see individuals well</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Conc, <span class="dt">group=</span> ID)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>() +
<span class="st">  </span><span class="kw">facet_wrap</span>(~ID, <span class="dt">scales=</span> <span class="st">"free"</span>)</code></pre></div>
<p><img src="multiplot_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>What we’d like to be able to do is split up into ‘bins’ of specified numbers of individuals to then plot out multiple plots</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># this will automatically create a column of bins such that the</span>
<span class="co"># specified number of individuals is in each bin, in this case</span>
<span class="co"># 9 ids per bin</span>

<span class="co"># split the original dataset into subdatasets corresponding to each bin (list of dataframes)</span>
split_dat &lt;-<span class="st"> </span>dat %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PLOTS =</span> <span class="kw"><a href="../reference/ids_per_plot.html">ids_per_plot</a></span>(ID, <span class="dv">4</span>)) %&gt;%<span class="st"> </span><span class="co"># default is 9 per subplot</span>
<span class="st">  </span><span class="kw">split</span>(.[[<span class="st">"PLOTS"</span>]])</code></pre></div>
<p>To handle plotting each subdataframe, you need to wrap your normal ggplot into a function. You will then apply this function with <code>map</code> to each subdataframe. So in this case it is just like a normal plot, but wrapped up in a function, which takes 1 argument (the dataframe) and outputs the plot</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_conc_time &lt;-<span class="st"> </span>function(df) {
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Conc, <span class="dt">group=</span> ID)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>() +
<span class="st">  </span><span class="kw">facet_wrap</span>(~ID, <span class="dt">scales=</span> <span class="st">"free"</span>)
}</code></pre></div>
<p>To apply the above function we use <code>map</code> from <code>purrr</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">split_dat %&gt;%<span class="st"> </span><span class="kw">map</span>(p_conc_time) </code></pre></div>
<pre><code>## $`1`</code></pre>
<p><img src="multiplot_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<pre><code>## 
## $`2`</code></pre>
<p><img src="multiplot_files/figure-html/unnamed-chunk-6-2.png" width="672"></p>
<pre><code>## 
## $`3`</code></pre>
<p><img src="multiplot_files/figure-html/unnamed-chunk-6-3.png" width="672"></p>
<pre><code>## 
## $`4`</code></pre>
<p><img src="multiplot_files/figure-html/unnamed-chunk-6-4.png" width="672"></p>
<pre><code>## 
## $`5`</code></pre>
<p><img src="multiplot_files/figure-html/unnamed-chunk-6-5.png" width="672"></p>
<p>As you can notice from the vignette, there is still a code-based output separating each subplot, which is not ideal for reporting. As such, there is a special function <code>print_plots</code> in PKPDmisc that will clean up the output slightly. It also automatically restarts the page numbering if knitting to PDF to page 1, making it each to extract only the pages related to plots to embed cleanly in other reports.</p>
<p>To use <code>print_plots</code> we want to save the ggplot output (rather than let it be printed directly) and give that to print plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot_list &lt;-<span class="st"> </span>split_dat %&gt;%<span class="st"> </span><span class="kw">map</span>(p_conc_time) </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/print_plots.html">print_plots</a></span>(plot_list)</code></pre></div>
<p><img src="multiplot_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p><img src="multiplot_files/figure-html/unnamed-chunk-8-2.png" width="672"></p>
<p><img src="multiplot_files/figure-html/unnamed-chunk-8-3.png" width="672"></p>
<p><img src="multiplot_files/figure-html/unnamed-chunk-8-4.png" width="672"></p>
<p><img src="multiplot_files/figure-html/unnamed-chunk-8-5.png" width="672"></p>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## NULL
## 
## [[3]]
## NULL
## 
## [[4]]
## NULL
## 
## [[5]]
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">session_info</span>()</code></pre></div>
<pre><code>## Session info -------------------------------------------------------------</code></pre>
<pre><code>##  setting  value                       
##  version  R version 3.3.2 (2016-10-31)
##  system   x86_64, mingw32             
##  ui       RStudio (1.1.38)            
##  language (EN)                        
##  collate  English_United States.1252  
##  tz       America/New_York            
##  date     2017-02-13</code></pre>
<pre><code>## Packages -----------------------------------------------------------------</code></pre>
<pre><code>##  package      * version     date      
##  assertthat     0.1         2013-12-06
##  backports      1.0.5       2017-01-18
##  BH             1.62.0-1    2016-11-19
##  callr          1.0.0.9000  2016-12-29
##  chron          2.3-47      2015-06-24
##  colorspace     1.3-0       2016-11-10
##  commonmark     1.1         2016-12-13
##  crayon         1.3.2       2016-06-28
##  data.table     1.9.6       2015-09-19
##  DBI            0.5-1       2016-09-10
##  desc           1.0.1       2016-09-23
##  devtools       1.12.0.9000 2016-12-29
##  digest         0.6.11      2017-01-03
##  dplyr        * 0.5.0       2016-06-24
##  evaluate       0.10        2016-10-11
##  ggplot2      * 2.2.0       2016-11-11
##  gtable         0.2.0       2016-02-26
##  highlight      0.4.7       2015-04-20
##  htmltools      0.3.5       2016-03-21
##  knitr          1.15.1      2016-11-22
##  labeling       0.3         2014-08-23
##  lazyeval       0.2.0       2016-06-12
##  magrittr       1.5         2014-11-22
##  memoise        1.0.0       2016-01-29
##  munsell        0.4.3       2016-02-13
##  pkgbuild       0.0.0.9000  2016-12-29
##  pkgdown        0.1.0.9000  2016-12-29
##  pkgload        0.0.0.9000  2016-12-29
##  PKPDdatasets * 0.1.0       2016-11-18
##  PKPDmisc     * 0.4.5       &lt;NA&gt;      
##  plyr           1.8.4       2016-06-08
##  purrr        * 0.2.2       2016-06-18
##  R6             2.2.0       2016-10-05
##  Rcpp           0.12.9      2017-01-14
##  readr          1.0.0       2016-08-03
##  reshape2       1.4.2       2016-10-22
##  rmarkdown      1.3         2016-12-29
##  roxygen2       5.0.1.9000  2016-12-29
##  rprojroot      1.2         2017-01-16
##  scales         0.4.1       2016-11-09
##  stringi        1.1.2       2016-10-01
##  stringr        1.1.0       2016-08-19
##  testthat       1.0.2.9000  2016-12-29
##  tibble         1.2         2016-08-26
##  whisker        0.3-2       2013-04-28
##  withr          1.0.2       2016-06-20
##  xml2           1.0.0.9002  2016-12-29
##  yaml           2.1.14      2016-11-12
##  source                                
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  Github (mangothecat/callr@3007ba2)    
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  Github (hadley/devtools@1ce84b0)      
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  Github (r-pkgs/pkgbuild@65eace0)      
##  Github (hadley/pkgdown@f23ddb0)       
##  Github (r-pkgs/pkgload@def2b10)       
##  Github (dpastoor/PKPDdatasets@52880fa)
##  local                                 
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  Github (rstudio/rmarkdown@3276760)    
##  Github (klutometis/roxygen@d2c7cfd)   
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  Github (hadley/testthat@3b2f225)      
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  Github (hadley/xml2@78112cf)          
##  CRAN (R 3.3.2)</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Devin Pastoor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
