<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Noncompartmental Analysis • PKPDmisc</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">PKPDmisc</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Noncompartmental Analysis</h1>
                        <h4 class="author">Devin Pastoor</h4>
            
            <h4 class="date">2017-02-13</h4>
          </div>

    
    
<div class="contents">
<p>For initial analysis, or in times where more complex analysis - such as nonlinear mixed effects modeling - is unnecessary, noncompartmental analysis is frequently used. While there are R packages, such as <code>metrumrg</code> or <code>PK</code> packages, the functionality is too complex and does not provide the flexibility to easily perform most of the basic functions needed without massaging or wringing your data into the necessary formats. The NCA functions in <code>PKPDmisc</code> are designed to be robust, but generalizable, allowing multiple data designs and software to be easily utilized.</p>
<p>In addition, while it is possible to use these functions in base R, it is highly recommended to use <code>dplyr</code> to supplement much of the surrounding data manipulation for both speed and clarity.</p>
<p>While other resources are available to get started with dplyr, briefly, the general workflow will be as follows:</p>
<ul>
<li>take raw data</li>
<li>filter unnecessary data</li>
<li>group data</li>
<li>use summarize or mutate for the calculations.</li>
</ul>
<p>However, there are certain analyses that are frequently used enough that <code>PKPDmisc</code> provides wrapper functions to reduce the above steps to a single line of code.</p>
<p>For those getting accustomed to R, keep in mind that there is also simple examples provided with each function that are available by doing <code>?&lt;function&gt;</code>, so for example <code><a href="../reference/auc_partial.html">?auc_partial</a></code>.</p>
<p>For the examples, the <code>sd_oral_richpk</code> dataset from <code>PKPDdatasets</code> will be used.</p>
<p>To install, run <code>devtools::install_github("dpastoor/PKPDdatasets")</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"PKPDdatasets"</span>)
<span class="kw">library</span>(<span class="st">"PKPDmisc"</span>)
<span class="kw">library</span>(<span class="st">"dplyr"</span>)
pkdat &lt;-<span class="st"> </span>sd_oral_richpk
<span class="kw">head</span>(pkdat)</code></pre></div>
<pre><code>##   ID Time  Amt      Conc      Age   Weight Gender     Race Dose
## 1  1 0.00 5000  0.000000 56.09591 94.19649   Male Hispanic 5000
## 2  1 0.25    0  8.612809 56.09591 94.19649   Male Hispanic 5000
## 3  1 0.50    0 19.436818 56.09591 94.19649   Male Hispanic 5000
## 4  1 1.00    0 34.006699 56.09591 94.19649   Male Hispanic 5000
## 5  1 2.00    0 30.228800 56.09591 94.19649   Male Hispanic 5000
## 6  1 3.00    0 31.299610 56.09591 94.19649   Male Hispanic 5000</code></pre>
<div id="common-summary-functions" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#common-summary-functions" class="anchor"> </a></body></html>Common summary functions</h1>
<p>For a number of tasks that are commonly run, summary functions reduce the number of steps necessary. While I will not highlight each here, a quick glance at the package source code can show which functions are available. The API follows that functions named <code>s_&lt;function&gt;</code> will provide these multiple steps at once.</p>
<p>In general, each function is designed to take a <em>grouped dataframe</em> from <code>dplyr</code> to provide the function insight as to how to handle the overall data, so in general the analysis will will look like:</p>
<pre><code>df %&gt;% group_by(&lt;grouping var&gt;) %&gt;% s_&lt;function&gt;()</code></pre>
<p>The first such function is <code><a href="../reference/s_pauc_.html">s_pauc()</a></code>. This function can give multiple partial auc values, with each column being named <code>pAUC&lt;tfirst&gt;_&lt;tlast&gt;</code>. Multiple partial AUC slices can be requested by passing a list of requested times.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pkdat %&gt;%<span class="st"> </span><span class="kw">group_by</span>(ID) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/s_pauc_.html">s_pauc</a></span>(Time, Conc, <span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">8</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">24</span>), <span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">24</span>))) %&gt;%
<span class="st">  </span>head</code></pre></div>
<pre><code>## Source: local data frame [6 x 4]
## Groups: ID [6]
## 
##      ID  pAUC0_8  pAUC0_24 pAUC8_24
##   &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1     1 204.2096  385.5759 181.3663
## 2     2 523.2355 1203.4948 680.2593
## 3     3 315.8860  466.3116 150.4255
## 4     4 564.1666 1219.6364 655.4698
## 5     5 301.9122  487.5681 185.6559
## 6     6 154.0215  295.2480 141.2265</code></pre>
<p>Similar to <code>dplyr</code> and <code>ggplot2</code> the summary functions use non-standard evaluation (no quotes required), however this is not conducive to programming or for use inside of other functions. As such, a standard evaluation version is provided with the nomenclature <code>s_&lt;function&gt;_</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">paucs &lt;-<span class="st"> </span>pkdat %&gt;%<span class="st"> </span><span class="kw">group_by</span>(ID) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/s_pauc_.html">s_pauc_</a></span>(<span class="st">"Time"</span>, <span class="st">"Conc"</span>, <span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">8</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">24</span>), <span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">24</span>)), <span class="dt">digits =</span><span class="dv">1</span>)
<span class="kw">head</span>(paucs)</code></pre></div>
<pre><code>## Source: local data frame [6 x 4]
## Groups: ID [6]
## 
##      ID pAUC0_8 pAUC0_24 pAUC8_24
##   &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1     1   204.2    385.6    181.4
## 2     2   523.2   1203.5    680.3
## 3     3   315.9    466.3    150.4
## 4     4   564.2   1219.6    655.5
## 5     5   301.9    487.6    185.7
## 6     6   154.0    295.2    141.2</code></pre>
<p>Often once AUC or cmax statistics have been calculated, quantiles are calculated to create quantile plots or other summary evaluations. Here, the <code>s_quantiles</code> function can be used.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">paucs %&gt;%<span class="st"> </span><span class="kw">ungroup</span>() %&gt;%<span class="st"> </span><span class="kw"><a href="../reference/s_quantiles_.html">s_quantiles</a></span>(pAUC0_24, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>))</code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   pAUC0_24_q0 pAUC0_24_q25 pAUC0_24_q50 pAUC0_24_q75 pAUC0_24_q100
##         &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;
## 1       161.4       456.65        590.3      886.975        1376.9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">paucs %&gt;%<span class="st"> </span><span class="kw">ungroup</span>() %&gt;%<span class="st"> </span><span class="kw"><a href="../reference/s_quantiles_.html">s_quantiles_</a></span>(<span class="st">"pAUC0_24"</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>))</code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   pAUC0_24_q0 pAUC0_24_q25 pAUC0_24_q50 pAUC0_24_q75 pAUC0_24_q100
##         &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;
## 1       161.4       456.65        590.3      886.975        1376.9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">session_info</span>()</code></pre></div>
<pre><code>## Session info -------------------------------------------------------------</code></pre>
<pre><code>##  setting  value                       
##  version  R version 3.3.2 (2016-10-31)
##  system   x86_64, mingw32             
##  ui       RStudio (1.1.38)            
##  language (EN)                        
##  collate  English_United States.1252  
##  tz       America/New_York            
##  date     2017-02-13</code></pre>
<pre><code>## Packages -----------------------------------------------------------------</code></pre>
<pre><code>##  package      * version     date      
##  assertthat     0.1         2013-12-06
##  backports      1.0.5       2017-01-18
##  BH             1.62.0-1    2016-11-19
##  callr          1.0.0.9000  2016-12-29
##  chron          2.3-47      2015-06-24
##  colorspace     1.3-0       2016-11-10
##  commonmark     1.1         2016-12-13
##  crayon         1.3.2       2016-06-28
##  data.table     1.9.6       2015-09-19
##  DBI            0.5-1       2016-09-10
##  desc           1.0.1       2016-09-23
##  devtools       1.12.0.9000 2016-12-29
##  digest         0.6.11      2017-01-03
##  dplyr        * 0.5.0       2016-06-24
##  evaluate       0.10        2016-10-11
##  ggplot2      * 2.2.0       2016-11-11
##  gtable         0.2.0       2016-02-26
##  highlight      0.4.7       2015-04-20
##  htmltools      0.3.5       2016-03-21
##  knitr          1.15.1      2016-11-22
##  labeling       0.3         2014-08-23
##  lazyeval       0.2.0       2016-06-12
##  magrittr       1.5         2014-11-22
##  memoise        1.0.0       2016-01-29
##  munsell        0.4.3       2016-02-13
##  pkgbuild       0.0.0.9000  2016-12-29
##  pkgdown        0.1.0.9000  2016-12-29
##  pkgload        0.0.0.9000  2016-12-29
##  PKPDdatasets * 0.1.0       2016-11-18
##  PKPDmisc     * 0.4.5       &lt;NA&gt;      
##  plyr           1.8.4       2016-06-08
##  purrr        * 0.2.2       2016-06-18
##  R6             2.2.0       2016-10-05
##  Rcpp           0.12.9      2017-01-14
##  readr          1.0.0       2016-08-03
##  reshape2       1.4.2       2016-10-22
##  rmarkdown      1.3         2016-12-29
##  roxygen2       5.0.1.9000  2016-12-29
##  rprojroot      1.2         2017-01-16
##  rstudioapi     0.6         2016-06-27
##  scales         0.4.1       2016-11-09
##  stringi        1.1.2       2016-10-01
##  stringr        1.1.0       2016-08-19
##  testthat       1.0.2.9000  2016-12-29
##  tibble         1.2         2016-08-26
##  whisker        0.3-2       2013-04-28
##  withr          1.0.2       2016-06-20
##  xml2           1.0.0.9002  2016-12-29
##  yaml           2.1.14      2016-11-12
##  source                                
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  Github (mangothecat/callr@3007ba2)    
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  Github (hadley/devtools@1ce84b0)      
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  Github (r-pkgs/pkgbuild@65eace0)      
##  Github (hadley/pkgdown@f23ddb0)       
##  Github (r-pkgs/pkgload@def2b10)       
##  Github (dpastoor/PKPDdatasets@52880fa)
##  local                                 
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  Github (rstudio/rmarkdown@3276760)    
##  Github (klutometis/roxygen@d2c7cfd)   
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  Github (hadley/testthat@3b2f225)      
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  CRAN (R 3.3.2)                        
##  Github (hadley/xml2@78112cf)          
##  CRAN (R 3.3.2)</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#common-summary-functions">Common summary functions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Devin Pastoor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
